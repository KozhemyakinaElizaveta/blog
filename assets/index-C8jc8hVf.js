import{f as I,j as e,c as R,$ as f,S as A,u as G,F as l,T as h,r as x,B as $,a as v}from"./index-DNp95QVJ.js";import{C as B,I as b}from"./Input-DQB6JHOu.js";const w=I(function(o,s){const{templateAreas:a,gap:i,rowGap:n,columnGap:c,column:u,row:d,autoFlow:p,autoRows:g,templateRows:t,autoColumns:j,templateColumns:C,...S}=o,y={display:"grid",gridTemplateAreas:a,gridGap:i,gridRowGap:n,gridColumnGap:c,gridAutoColumns:j,gridColumn:u,gridRow:d,gridAutoFlow:p,gridAutoRows:g,gridTemplateRows:t,gridTemplateColumns:C};return e.jsx(R.div,{ref:s,__css:y,...S})});w.displayName="Grid";const m="https://blog-z5et.onrender.com";function z(r,o,s,a){return f.post(`${m}/api/posts/create`,{message:r,date:o,authorId:s},{headers:{Authorization:`Bearer ${a}`},withCredentials:!0})}async function P(r,o){return f.get(`${m}/api/posts/user/${r}`,{headers:{Authorization:`Bearer ${o}`},withCredentials:!0})}async function k(r,o){return f.delete(`${m}/api/posts/${r}`,{headers:{Authorization:`Bearer ${o}`},withCredentials:!0})}const D=()=>e.jsx(B,{w:"100%",h:"100%",children:e.jsx(A,{w:"50px",h:"50px",color:"blue.300"})}),F=({title:r,date:o,id:s})=>{const a=G(),i=localStorage.getItem("refresh"),n=()=>{i!==null&&(k(s,i),a(0))};return e.jsxs(l,{flexDirection:"column",bgColor:"gray.100",w:"100%",h:"100%",borderRadius:"20px",p:"20px",gap:"10px",justifyContent:"space-between",children:[e.jsx(h,{fontWeight:500,lineHeight:"20px",fontSize:"17px",children:r}),e.jsxs(l,{alignItems:"center",justifyContent:"space-between",children:[e.jsx(h,{fontSize:"12px",fontWeight:400,children:o}),e.jsx(h,{fontSize:"12px",cursor:"pointer",color:"red.400",_hover:{color:"red.500"},onClick:n,children:"Удалить"})]})]})},T=()=>{const[r,o]=x.useState(""),[s,a]=x.useState([]),i=localStorage.getItem("id"),n=localStorage.getItem("refresh"),c=i?parseInt(i,10):null,[u,d]=x.useState(!1);x.useEffect(()=>{p()},[]);const p=async()=>{if(!(c===null||n===null))try{const t=await P(c,n);a(t.data)}catch(t){console.error("Failed to fetch posts:",t)}},g=async()=>{if(!r||!c){console.error("Message and author ID are required.");return}if(d(!0),n!==null)try{const t=new Date().toISOString();await z(r,t,c,n),o(""),p()}catch(t){console.error("Failed to create post:",t)}finally{d(!1)}};return e.jsxs(l,{w:"100%",h:"100%",px:"25px",position:"relative",flexDir:"column",children:[e.jsxs(l,{gap:"10px",pb:"20px",children:[e.jsx(b,{borderRadius:"10px",w:"500px",value:r,onChange:t=>o(t.target.value),placeholder:"Напишите что-нибудь..."}),e.jsx($,{onClick:g,children:"Добавить"})]}),s&&!u&&e.jsx(l,{w:"100%",h:"100%",justifyContent:"flex-start",children:e.jsx(w,{templateColumns:["repeat(auto-fill, minmax(324px, 1fr))"],gridRowGap:"20px",gridColumnGap:"20px",children:s==null?void 0:s.map(t=>e.jsx(v,{w:"minmax(324px, 1fr)",children:e.jsx(F,{title:t.message,date:new Date(t.date).toLocaleString(),id:t.id})},t==null?void 0:t.id))})}),u&&e.jsx(D,{}),s.length===0&&e.jsx(l,{w:"100%",h:"100%",align:"center",justify:"center",children:e.jsx(h,{fontSize:"24px",fontWeight:600,children:"Здесь пока что пусто"})})]})},L=()=>e.jsx(l,{h:"80vh",children:e.jsx(T,{})});export{L as default};
